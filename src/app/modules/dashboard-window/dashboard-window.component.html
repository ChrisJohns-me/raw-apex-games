<app-ui-container primaryTitle="Dashboard" [isDesktopWindow]="true" [isTitlebarDraggable]="true" [isContentDraggable]="false">
    <div class="control-bar">
        <button (click)="ultTimerWindowEnabled = !ultTimerWindowEnabled">
            Ult Timer [{{ ultTimerWindowEnabled ? "enabled" : "disabled" }}]
        </button>
        <button (click)="matchTimerWindowEnabled = !matchTimerWindowEnabled">
            Match Timer [{{ matchTimerWindowEnabled ? "enabled" : "disabled" }}]
        </button>
        <button (click)="damageCollectorWindowEnabled = !damageCollectorWindowEnabled">
            Damage Collector [{{ damageCollectorWindowEnabled ? "enabled" : "disabled" }}]
        </button>
        <button (click)="isTrackingEnabled = !isTrackingEnabled" disabled>
            {{ isTrackingEnabled ? "üü¢ Tracking Is On" : "‚ùå Tracking Is Off" }}
        </button>

        <span class="control-bar-right pulse" *ngIf="hasRecentlyTrackedMatchSummary">‚úîÔ∏è Last Match Tracked</span>
    </div>

    <section class="pane-container">
        <div class="pane" style="min-width: 150px; max-width: 300px; flex: 1 1 50%">
            <h1>Inferences</h1>
            <div>
                <p class="inference-item">Game</p>
                <div class="sub-inference-items">
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        <a (click)="gameProcess.isRunning$.next(!gameProcess.isRunning$.value)">IsRunning</a>:
                        {{ gameProcess.isRunning$ | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        <a (click)="gameProcess.isInFocus$.next(!gameProcess.isInFocus$)">IsInFocus</a>:
                        {{ gameProcess.isInFocus$ | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        GamePhase: {{ game.phase$ | async }}
                    </p>
                </div>

                <p class="inference-item">Match</p>
                <div class="sub-inference-items">
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        State: {{ (match.state$ | async)?.state }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        Map: {{ (matchMap.map$ | async)?.friendlyName }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        GameMode: {{ (match.gameMode$ | async)?.friendlyName }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        MatchDuration: {{ matchDuration | date: "mm:ss" }}
                    </p>
                </div>
                <p class="inference-item">Teammates</p>
                <div class="sub-inference-items">
                    <p
                        class="inference-item"
                        appHighlightOnChange
                        [highlightColor]="changedHighlightColor"
                        *ngFor="let teammate of (matchRoster.teammateRoster$ | async)?.allPlayers"
                    >
                        {{ teammate.name }} [{{ teammate.legend?.friendlyName }}]
                    </p>
                </div>

                <p class="inference-item">Match Roster</p>
                <div class="sub-inference-items">
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        Tabs Teams: {{ matchRoster.numTeams$ | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        Tabs Players: {{ matchRoster.numPlayers$ | async }}
                    </p>
                </div>

                <p class="inference-item">Player</p>
                <div class="sub-inference-items">
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        PlayerName: {{ player.myName$ | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        PlayerStatus: {{ matchPlayer.myState$ | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        Legend: {{ (matchPlayerLegend.myLegend$ | async)?.friendlyName }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        Placement: {{ matchPlayerStats.myPlacement$ | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        Victory: {{ matchPlayerStats.victory$ | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        UltimatePercent: {{ matchPlayerLegend.myUltimateCooldown$ | async | percent: "0.0-0" }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        Kills: {{ matchPlayerStats.myEliminations | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        Assists: {{ matchPlayerStats.myAssists$ | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        Damage: {{ matchPlayerStats.myDamage$ | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        <del>Spectators</del>: {{ matchPlayerStats.mySpectators$ | async }}
                    </p>
                </div>

                <p
                    class="inference-item has-tooltip"
                    title="Info directly from Overwolf's me.totalDamageDealt data. 
                Damage amount does not take into consideration victim's HP, only the raw inflicted amount.
                 eg. A victim's HP at 1 and a damage amount of 20 is still recorded at 20 and not 1; even though the
                 damage required to knockdown the victim is 1.
                The contained damage amount will then appear to be inflated."
                >
                    TotalDamageDealt: {{ matchPlayerStats.myTotalDamageDealt$ | async }}
                </p>

                <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                    Item In Use: {{ (matchPlayerInventory.myInUseItem$ | async)?.friendlyName }}
                </p>
                <p class="inference-item">Weapons</p>
                <div class="sub-inference-items">
                    <div
                        class="inference-item"
                        appHighlightOnChange
                        [highlightColor]="changedHighlightColor"
                        *ngFor="let weaponItem of matchPlayerInventory.myWeaponSlots$ | async | keyvalue"
                    >
                        {{ weaponItem.value?.item?.friendlyName }}
                    </div>
                </div>

                <p class="inference-item">Player Inventory</p>
                <div class="sub-inference-items">
                    <div
                        class="inference-item"
                        appHighlightOnChange
                        [highlightColor]="changedHighlightColor"
                        *ngFor="let slotItem of matchPlayerInventory.myInventorySlots$ | async | keyvalue"
                    >
                        {{ slotItem.value?.item?.friendlyName ? slotItem.value?.item?.friendlyName : slotItem.value?.item?.id }}
                        {{ slotItem.value?.amount || 0 > 0 ? "[" + slotItem.value?.amount + "]" : "" }}
                    </div>
                </div>

                <p class="inference-item">Player Location</p>
                <div class="sub-inference-items">
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        LocationPhase: {{ matchPlayerLocation.myLocationPhase$ | async }}
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        Coordinates:
                        <span *ngFor="let coord of matchPlayerLocation.myCoordinates$ | async | keyvalue"
                            >{{ coord.value < Infinity ? coord.value : "-" }}{{ coord.key !== "z" ? ", " : "" }}
                        </span>
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        StartingCoordinates:
                        <span *ngFor="let startingCoord of matchPlayerLocation.myStartingCoordinates$ | async | keyvalue"
                            >{{ startingCoord.value < Infinity ? startingCoord.value : "-" }}{{ startingCoord.key !== "z" ? ", " : "" }}
                        </span>
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        LandingCoordinates:
                        <span *ngFor="let landingCoord of matchPlayerLocation.myLandingCoordinates$ | async | keyvalue"
                            >{{ landingCoord.value < Infinity ? landingCoord.value : "-" }}{{ landingCoord.key !== "z" ? ", " : "" }}
                        </span>
                    </p>
                    <p class="inference-item" appHighlightOnChange [highlightColor]="changedHighlightColor">
                        EndingCoordinates:
                        <span *ngFor="let endingCoord of matchPlayerLocation.myEndingCoordinates$ | async | keyvalue"
                            >{{ endingCoord.value < Infinity ? endingCoord.value : "-" }}{{ endingCoord.key !== "z" ? ", " : "" }}
                        </span>
                    </p>
                </div>
            </div>
        </div>
        <div class="pane">
            <h1>Game Log</h1>
            <button (click)="onInjectLogClick()">Inject Log</button>
            <button (click)="clearLog()">Clear</button>
            <label>
                <input type="checkbox" [checked]="autoClearLog" (change)="autoClearLog = !autoClearLog" />
                Auto Clear
            </label>
            <textarea class="log-box" readonly>{{ gameLog }}</textarea>
        </div>
    </section>
</app-ui-container>
